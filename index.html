<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Website</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f4f4f4;
    }
    header {
      background: #333; color: #fff;
      padding: 1em; text-align: center;
    }
    nav {
      background: #444; display: flex;
      justify-content: center;
    }
    nav button {
      background: none; border: none;
      color: #fff; padding: 1em;
      cursor: pointer; font-size: 1em;
    }
    nav button:hover { background: #666; }
    main {
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    .card-container {
      display: flex; flex-wrap: wrap; gap: 20px;
    }
    .card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      padding: 20px;
      flex: 1 1 250px;
    }
    .card img {
      max-width: 100%; border-radius: 10px;
    }
    .rsvp-card h2 {
      margin-top: 10px; text-align: center;
    }
  </style>
</head>
<body>
  <header>
    <h1>Welcome to Our Site</h1>
  </header>
  <nav>
    <button onclick="showHome()">Home</button>
    <button onclick="showSoftball()">Softball</button>
  </nav>
  <main id="main"></main>

  <script type="module">
    // --- Firebase Setup ---
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, addDoc, onSnapshot, query, orderBy } 
      from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBgbKSD_JfkiCObRRdmQoxIYcN1PDgY7pI",
      authDomain: "website-9c4b4.firebaseapp.com",
      projectId: "website-9c4b4",
      storageBucket: "website-9c4b4.firebasestorage.app",
      messagingSenderId: "259113173829",
      appId: "1:259113173829:web:88bdc84c56541e0fbb742c",
      measurementId: "G-6XR3EN4YCD"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // --- Render helper ---
    function render(html) {
      document.getElementById("main").innerHTML = html;
    }

    // --- Home Page ---
    function showHome() {
      render(`
        <div class="card-container">
          <div class="card">
            <h2>Welcome</h2>
            <p>This is the home page of the site. Use the navigation above to explore.</p>
          </div>
        </div>
      `);
    }

    // --- Softball Page with RSVP + Blog ---
    function showSoftball() {
      render(`
        <div class="card-container">
          <!-- RSVP Section -->
          <a href="https://web.gc.com/teams/i0ZmKWEfWcVh/2025-fall-saasholes" target="_blank" style="text-decoration: none; color: inherit;">
            <div class="card rsvp-card">
              <img src="https://thumbs.dreamstime.com/b/softball-ball-face-vector-image-10361808.jpg" alt="Softball RSVP">
              <h2>Looking to RSVP for Softball? Click here!</h2>
            </div>
          </a>

          <!-- Blog Section -->
          <div class="card" style="flex: 1 1 100%;">
            <h2>Softball Blog</h2>
            <div id="blog-posts"></div>
            <h3>Add a Post</h3>
            <textarea id="new-post" rows="3" style="width:100%;"></textarea><br>
            <button id="add-post-btn">Post</button>
          </div>
        </div>
      `);

      document.getElementById("add-post-btn").addEventListener("click", addPost);
      loadPosts();
    }

    // --- Firestore Blog Functions ---
    const postsRef = collection(db, "softballPosts");

    function loadPosts() {
      const q = query(postsRef, orderBy("createdAt", "desc"));
      onSnapshot(q, (snapshot) => {
        const container = document.getElementById("blog-posts");
        if (!container) return;
        container.innerHTML = "";
        snapshot.forEach((doc) => {
          const post = doc.data();
          const postId = doc.id;
          container.innerHTML += `
            <div style="margin-bottom:20px; padding:15px; border:1px solid #ddd; border-radius:8px; background:#f9f9f9;">
              <p>${post.text}</p>
              <div style="margin-top:10px;">
                <h4>Comments</h4>
                <div id="comments-${postId}"></div>
                <input id="comment-input-${postId}" placeholder="Write a comment" style="width:80%;">
                <button onclick="addComment('${postId}')">Comment</button>
              </div>
            </div>
          `;
          loadComments(postId);
        });
      });
    }

    async function addPost() {
      const textarea = document.getElementById("new-post");
      if (!textarea.value.trim()) return;
      await addDoc(postsRef, {
        text: textarea.value,
        createdAt: new Date()
      });
      textarea.value = "";
    }

    function loadComments(postId) {
      const commentsRef = collection(db, `softballPosts/${postId}/comments`);
      const q = query(commentsRef, orderBy("createdAt", "asc"));
      onSnapshot(q, (snapshot) => {
        const container = document.getElementById("comments-" + postId);
        if (!container) return;
        container.innerHTML = "";
        snapshot.forEach((doc) => {
          const comment = doc.data();
          container.innerHTML += `<p style="margin:4px 0;">- ${comment.text}</p>`;
        });
      });
    }

    async function addComment(postId) {
      const input = document.getElementById("comment-input-" + postId);
      if (!input.value.trim()) return;
      const commentsRef = collection(db, `softballPosts/${postId}/comments`);
      await addDoc(commentsRef, {
        text: input.value,
        createdAt: new Date()
      });
      input.value = "";
    }

    // --- Start on Home page ---
    showHome();

    // Expose comment function globally
    window.addComment = addComment;
  </script>
</body>
</html>
